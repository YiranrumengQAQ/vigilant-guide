<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft 皮肤查看器</title>
    <script src="https://cdn.jsdelivr.net/npm/skinview3d@latest/dist/skinview3d.bundle.js"></script>
    
    <style>
        /* 1. 全局样式 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* 2. 主应用容器 (卡片) */
        .skin-app {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px;
            gap: 20px;
            width: 350px;
        }

        h1 {
            font-size: 24px;
            font-weight: 600;
            margin: 0;
            color: #fff;
        }

        /* 3. 3D 视图画布 */
        #skin-viewer-canvas {
            width: 300px;
            height: 350px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: grab;
        }
        #skin-viewer-canvas:active {
            cursor: grabbing;
        }

        /* 4. 控制区域 */
        .controls {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* 5. 自定义文件上传按钮 */
        .file-label {
            background: #3498db;
            color: #fff;
            padding: 12px 15px;
            border-radius: 8px;
            font-weight: 500;
            text-align: center;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .file-label:hover {
            background: #2980b9;
        }
        /* 隐藏原始的文件输入框 */
        #skin-file-input {
            display: none;
        }

        /* 6. 模型切换 (分段控件) */
        .model-options {
            display: flex;
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .model-option {
            flex: 1; /* 均分空间 */
            text-align: center;
            padding: 10px 0;
            color: #bdc3c7;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s ease, color 0.3s ease;
            position: relative; /* 用于伪元素定位 */
        }
        
        /* 隐藏原始的 radio 按钮 */
        .model-options input[type="radio"] {
            display: none;
        }

        /* 选中状态的样式 */
        .model-options input[type="radio"]:checked + .model-option {
            background: #2ecc71;
            color: #fff;
            box-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
        }

        /* 分割线 */
        .model-option:first-of-type::after {
            content: '';
            position: absolute;
            right: 0;
            top: 20%;
            bottom: 20%;
            width: 1px;
            background: rgba(255, 255, 255, 0.1);
        }

        /* 提示文字 */
        .info-text {
            font-size: 14px;
            color: #95a5a6;
            text-align: center;
        }

    </style>
</head>
<body>

    <div class="skin-app">
        <h1>3D 皮肤查看器</h1>
        
        <canvas id="skin-viewer-canvas"></canvas>

        <p class="info-text" id="info-text">请上传皮肤 .png 文件</p>

        <div class="controls">
            <label for="skin-file-input" class="file-label">上传皮肤</label>
            <input type="file" id="skin-file-input" accept="image/png">

            <div class="model-options">
                <input type="radio" id="model-classic" name="model-type" value="classic" checked>
                <label class="model-option" for="model-classic">经典 (Classic)</label>
                
                <input type="radio" id="model-slim" name="model-type" value="slim">
                <label class="model-option" for="model-slim">纤细 (Slim)</label>
            </div>
        </div>
    </div>

    <script>
        // 1. 获取 DOM 元素
        const canvas = document.getElementById('skin-viewer-canvas');
        const fileInput = document.getElementById('skin-file-input');
        const modelRadios = document.querySelectorAll('input[name="model-type"]');
        const infoText = document.getElementById('info-text');

        // 2. 初始化 3D 查看器
        let skinViewer = new skinview3d.SkinViewer({
            canvas: canvas,
            width: 300,
            height: 350,
        });

        // 3. 添加轨道控制 (允许鼠标拖动旋转)
        let control = skinview3d.createOrbitControls(skinViewer);
        control.enableZoom = false; // 禁用缩放，保持简洁
        control.enablePan = false; // 禁用平移

        // 4. 添加行走动画 (让其更生动)
        skinViewer.animation = new skinview3d.WalkingAnimation();
        skinViewer.animation.speed = 1.5;

        // 5. 存储当前皮肤和模型
        let currentSkinUrl = null;
        let currentModel = 'classic';

        // 6. 更新查看器的函数
        function updateViewer() {
            // 只有当皮肤 URL 存在时才加载
            if (!currentSkinUrl) {
                return;
            }
            
            // 获取当前选中的模型
            currentModel = document.querySelector('input[name="model-type"]:checked').value;

            // 加载皮肤和模型
            skinViewer.loadSkin(currentSkinUrl, { model: currentModel });
            
            // 更新提示文字
            infoText.textContent = "可拖动鼠标旋转模型";
        }

        // 7. 监听文件上传事件
        fileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = () => {
                    // 将文件读取为 Data URL
                    currentSkinUrl = reader.result;
                    // 更新查看器
                    updateViewer();
                };
                reader.readAsDataURL(file);
            }
        });

        // 8. 监听模型切换事件
        modelRadios.forEach(radio => {
            radio.addEventListener('change', updateViewer);
        });

    </script>

</body>
</html>
